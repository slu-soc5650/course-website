---
date: 2016-03-09T00:11:02+01:00
title: Lecture 01 - Course Introduction
weight: 20
tags:
  - Analysis development
output:
  blogdown::html_page
---

<script src="/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="/rmarkdown-libs/jquery/jquery.min.js"></script>
<link href="/rmarkdown-libs/leaflet/leaflet.css" rel="stylesheet" />
<script src="/rmarkdown-libs/leaflet/leaflet.js"></script>
<link href="/rmarkdown-libs/leafletfix/leafletfix.css" rel="stylesheet" />
<link href="/rmarkdown-libs/leaflet-label/leaflet.label.css" rel="stylesheet" />
<script src="/rmarkdown-libs/leaflet-label/leaflet.label.js"></script>
<script src="/rmarkdown-libs/Proj4Leaflet/proj4-compressed.js"></script>
<script src="/rmarkdown-libs/Proj4Leaflet/proj4leaflet.js"></script>
<script src="/rmarkdown-libs/leaflet-binding/leaflet.js"></script>
<script src="/rmarkdown-libs/leaflet-providers/leaflet-providers.js"></script>
<script src="/rmarkdown-libs/leaflet-providers-plugin/leaflet-providers-plugin.js"></script>


<p><a class="btn btn-primary btn-outline btn-xs{{end}}" href="https://github.com/slu-soc5650/" target="_blank"> Open on <i class="fab fa-github fa-lg"></i> </a></p>
<p>This is our first class meeting, which takes place on January 22nd because of the Martin Luther King, Jr. holiday. We’ll cover some administrative material for the course, briefly go over the syllabus, and then start talking about what makes for an effective map. We’ll end the night by writing our first lines of <code>R</code> code(!) and making our first maps(!!).</p>
<div id="key-topics" class="section level2">
<h2>Key Topics</h2>
<p><i class="keyword"><i class="fas fa-tags"></i> Analysis development</i> <i class="keyword"><i class="fas fa-tags"></i> Cartography</i> <i class="package"><i class="fas fa-archive"></i> devtools</i> <i class="keyword"><i class="fas fa-tags"></i> Interactive maps</i> <i class="package"><i class="fas fa-archive"></i> leaflet</i> <i class="tool"><i class="fas fa-desktop"></i> R</i> <i class="keyword"><i class="fas fa-tags"></i> R packages</i> <i class="package"><i class="fas fa-archive"></i> stlData</i> <i class="package"><i class="fas fa-archive"></i> utils</i></p>
</div>
<div id="handouts" class="section level2">
<h2>Handouts</h2>
<p><a class="btn btn-primary btn-outline btn-xs{{end}}" href="https://github.com/slu-soc5650/" target="_blank"> Exercise - Email </a> <a class="btn btn-primary btn-outline btn-xs{{end}}" href="https://github.com/slu-soc5650/" target="_blank"> Exercise - Map </a> <a class="btn btn-primary btn-outline btn-xs{{end}}" href="https://github.com/slu-soc5650/" target="_blank"> Functions </a></p>
</div>
<div id="working-with-r-packages" class="section level2">
<h2>Working with R Packages</h2>
<p>During the semester, we’ll use some sample data for in-class exercises and lecture examples. To make things easy, these data available as an <code>R</code> package called <a href="https://chris-prener.github.io/stlData/"><code>stlData</code></a>. Packages are small software programs that extend <code>R</code>’s base functionality. Most packages we’ll use this semester are available via <a href="https://cran.r-project.org">CRAN</a>. However, our example data package is hosted on GitHub. While <code>R</code> has built-in functions for installing and updating packages from CRAN, it does not have these same tools for packages hosted elsewhere. We need a separate package called <code>devtools</code> to help us with the GitHub installation. To get started, you’ll need to fire up RStudio. In the console, enter the following function and hit return:</p>
<pre class="r"><code>install.packages(&quot;devtools&quot;)</code></pre>
<p>We only need to run this function once per package per user. After it is installed, and for each subsequent <code>R</code> session, we can open the package with the <code>library()</code> function:</p>
<pre class="r"><code>library(&quot;devtools&quot;)</code></pre>
<p>Each time you re-open RStudio, you will need to execute the <code>library()</code> function for all needed packages.</p>
<p>Now that we have <code>devtools</code> installed and loaded, we can install <code>stlData</code> with the following function:</p>
<pre class="r"><code>install_github(&quot;chris-prener/stlData&quot;)</code></pre>
<p>Once it installs, we can access the data included in <code>stlData</code> by loading the package:</p>
<pre class="r"><code>library(&quot;stlData&quot;)</code></pre>
<p>This will be our standard workflow for installing packages this semester. When a new package is introduced, you’ll need to pick the appropriate function based on where the package is hosted (CRAN or GitHub). Most packages will be available from CRAN. Once you have them installed, you will use <code>library()</code> to load the packages at the beginning of each session.</p>
</div>
<div id="leaflet-basics" class="section level2">
<h2>Leaflet Basics</h2>
<p>As a way to get to know <code>R</code> and RStudio, we’ll be working with the <code>R</code> package <a href="https://rstudio.github.io/leaflet/"><code>leaflet</code></a>. <code>leaflet</code> is the <code>R</code> implementation of <a href="http://leafletjs.com"><code>leaflet.js</code></a>, an open-source Java Script library for building interactive maps. To get started, you’ll need to install <code>leaflet</code> via CRAN:</p>
<pre class="r"><code>install.packages(&quot;leaflet&quot;)</code></pre>
<p>Just like before, we can open <code>leaflet</code> with the <code>library()</code> function:</p>
<pre class="r"><code>library(&quot;leaflet&quot;)</code></pre>
<div id="a-simple-map" class="section level3">
<h3>A Simple Map</h3>
<p><code>leaflet</code> itself is straightforward to get up and running. If we wanted an interactive map with a marker placed on-top of Morrissey Hall, we would use the following script entered into <code>R</code>:</p>
<pre class="r"><code>leaflet() %&gt;%
  addTiles() %&gt;%
  addMarkers(lng=-90.237104, lat=38.637547, popup=&quot;Morrissey Hall&quot;)</code></pre>
<p>The <code>leaflet()</code> function creates a map widget, and the <code>addTiles()</code> function adds a basemap to it. By default, <a href="https://www.openstreetmap.org">OpenStreetMap</a> is used for the basemap. Finally, we use <code>addMarkers()</code> to specify the longitude and latitude of our marker, and we enter in a label that will appear as a pop-up when a user clicks on the marker. <code>lng</code>, <code>lat</code>, and <code>popup</code> are all called “arguments” - these are used to control how a function operates.</p>
<p>The <code>%&gt;%</code> is called the “pipe operator”, and it is used to chain together functions in what we will call “pipelines”. This pipeline can be read like a list, with the word <strong>then</strong> substituted for each instance of <code>%&gt;%</code>:</p>
<ol style="list-style-type: decimal">
<li>First we create a map widget, <strong>then</strong></li>
<li>we add basemap tiles, <strong>then</strong></li>
<li>we add a marker at the given longitude and latitude.</li>
</ol>
<p>The code chunk above produces the following map in RStudio’s <strong>Viewer</strong> tab: <div id="htmlwidget-1" style="width:100%;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"maxNativeZoom":null,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"continuousWorld":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":null,"unloadInvisibleTiles":null,"updateWhenIdle":null,"detectRetina":false,"reuseTiles":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addMarkers","args":[38.637547,-90.237104,null,null,null,{"clickable":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},"Morrissey Hall",null,null,null,null,null,null]}],"limits":{"lat":[38.637547,38.637547],"lng":[-90.237104,-90.237104]}},"evals":[],"jsHooks":[]}</script> You can use the <strong>Show in new window</strong> icon (a white box with a small arrow facing up and right) to open the map in your web browser.</p>
</div>
<div id="changing-the-basemap" class="section level3">
<h3>Changing the Basemap</h3>
<p>To alter the basemap, we can use <code>addProviderTiles()</code> in place of <code>addTiles()</code>. I like the CartoDB “Positron” basemap. To use the Positron basemap, we create a second pipeline:</p>
<pre class="r"><code>leaflet() %&gt;%
  addProviderTiles(providers$CartoDB.Positron) %&gt;% 
  addMarkers(lng=-90.237104, lat=38.637547, popup=&quot;Morrissey Hall&quot;)</code></pre>
<p>Two things are important to note here. When we load the <code>leaflet</code> package, we have access to a data object called <code>providers</code>. You can use <code>names(providers)</code> to explore it. <code>providers</code> is a vector of items, each of which corresponds to a different basemap. We can select one of those items, <code>CartoDB.Positron</code>, by separating <code>providers</code> from the item name with a dollar sign (<code>$</code>). This is a classic way in which elements of a data set are accessed in <code>R</code> syntax.</p>
<p>The second code chunk produces the following map in RStudio’s <strong>Viewer</strong> tab: <div id="htmlwidget-2" style="width:100%;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-2">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["CartoDB.Positron",null,null,{"errorTileUrl":"","noWrap":false,"zIndex":null,"unloadInvisibleTiles":null,"updateWhenIdle":null,"detectRetina":false,"reuseTiles":false}]},{"method":"addMarkers","args":[38.637547,-90.237104,null,null,null,{"clickable":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},"Morrissey Hall",null,null,null,null,null,null]}],"limits":{"lat":[38.637547,38.637547],"lng":[-90.237104,-90.237104]}},"evals":[],"jsHooks":[]}</script></p>
</div>
</div>
<div id="loading-and-exploring-data" class="section level2">
<h2>Loading and Exploring Data</h2>
<p>Our example data package, <a href="https://chris-prener.github.io/stlData/"><code>stlData</code></a>, contains a simple table of some places that I frequent around campus in addition to Morrissey Hall. In the package, it is called <code>sluPlaces</code>. We can reference these data in our <code>leaflet()</code> call and again in the <code>addMarkers()</code> function to project (map) them onto our basemap. First, we need to assign these data to an object in our global environment. We’ll take the <code>sluPlaces</code> table and assign it to the object <code>sluData</code>:</p>
<pre class="r"><code>sluData &lt;- sluPlaces</code></pre>
<p>Notice how we always assign data in reverse like this, and that we don’t use an equal sign. <a href="http://blog.revolutionanalytics.com/2008/12/use-equals-or-arrow-for-assignment.html">These are both just R quirks that take some getting used to</a>. We can explore the data a number of ways, including with the <code>View()</code> function and the <code>str()</code> function:</p>
<pre class="r"><code>&gt; View(sluData)

&gt; str(sluData)
&#39;data.frame&#39;:   6 obs. of  4 variables:
 $ id  : num  1 2 3 4 5 6
 $ name: chr  &quot;Morrissey Hall&quot; &quot;Starbucks&quot; &quot;Simon Rec&quot; &quot;Pius Library&quot; ...
 $ lng : num  -90.2 -90.2 -90.2 -90.2 -90.2 ...
 $ lat : num  38.6 38.6 38.6 38.6 38.6 ...</code></pre>
<p>The <code>View()</code> function does not produce any console output, but does open a viewer that (reassuringly for some of you!) looks a bit like a spreadsheet. The <code>str()</code> function gives us an overview of the variables included in the data along with some sample values.</p>
</div>
<div id="data-sources-and-leaflet" class="section level2">
<h2>Data Sources and Leaflet</h2>
<p>Now that we have some data loaded in our global environment, we can project (map) it using <code>leaflet</code>. We need to reference the data frame (our data object) in the <code>leaflet()</code> call and both the longitude (<code>lng</code>) and latitude (<code>lat</code>) variable names in our <code>addMarkers()</code> call. We’ll also set the <code>name</code> variable to be the source for the popup text:</p>
<pre class="r"><code>leaflet(data = sluData) %&gt;%
  addProviderTiles(providers$CartoDB.Positron) %&gt;%  # Add alternative map tiles
  addMarkers(lng = ~lng, lat = ~lat, popup = ~name)</code></pre>
<p>Notice how we use the tilde symbol (<code>~</code>) in <code>addMarkers()</code> before the variable names. This is idiosyncratic to <code>leaflet</code>.</p>
<p>The code chunk produces the following plot:</p>
<div id="htmlwidget-3" style="width:100%;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-3">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["CartoDB.Positron",null,null,{"errorTileUrl":"","noWrap":false,"zIndex":null,"unloadInvisibleTiles":null,"updateWhenIdle":null,"detectRetina":false,"reuseTiles":false}]},{"method":"addMarkers","args":[[38.637547,38.635959,38.635283,38.636741,38.634973,38.636897],[-90.237104,-90.234837,-90.235841,-90.234972,-90.232955,-90.236313],null,null,null,{"clickable":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},["Morrissey Hall","Starbucks","Simon Rec","Pius Library","BSC","The Pond"],null,null,null,null,null,null]}],"limits":{"lat":[38.634973,38.637547],"lng":[-90.237104,-90.232955]}},"evals":[],"jsHooks":[]}</script>
<p>Congratulations - you have now made three maps!</p>
</div>
<div id="replication-code" class="section level2">
<h2>Replication Code</h2>
<p>All of the code used in our lecture today, in one place:</p>
<script data-gist-id="bc0420ef79e928319e682e3f74d659c0"></script>
</div>
